<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>better waves</title>
</head>

<body>
    <canvas></canvas>
    <script>
        const canvas = document.querySelector('canvas')
        const ctx = canvas.getContext('2d')
        ctx.fillStyle = '#000'
        const w = document.documentElement.clientWidth
        const h = document.documentElement.clientHeight
        canvas.width = w
        canvas.height = h
        let particles = []
        const makeParticle = (x, y, vx, vy) => {
            let p = particles.push({
                x, y, vx, vy, id: Math.random() * 1e10 >> 0
            })
            return p
        }
        const step = () => {
            let takenSpaces = []
            for (let i = particles.length - 1; i > 0; i--) {
                let p = particles[i]
                if (takenSpaces.includes([(p.x + p.vx / 1000) >> 0, (p.y + p.vy / 1000) >> 0])) {
                    p.vx *= -1
                    p.vy *= -1
                }
                if (p.x > w || p.x < 0){
                    p.x = w-p.x
                }
                if(p.y > h || p.y < 0){
                    p.y = h-p.y
                }
                p.x += (p.vx / 1000)
                p.y += (p.vy / 1000)
                takenSpaces.push(p.x >> 0, p.y >> 0)
                
            }
        }
        const render = () => {
            for (let i = particles.length - 1; i > 0; i--) {
                let p = particles[i]
                ctx.fillRect(p.x, p.y, 3, 3)
            }
        }
        setInterval(function () {
            step()
        }, 1)
        setInterval(function () {
            ctx.clearRect(0, 0, w, h)
            render()
        }, 50)
        let hw = w / 2 >> 0
        let hh = h / 2 >> 0
        const pi = 314
            for (let i = -pi / 4; i < pi / 4; i++) {
                let nvx = Math.cos(i / 100) * 50
                let nvy = Math.sin(i / 100) * 50
                makeParticle(hw + nvx, hh + nvy, nvx * 5, nvy * 5)
            }
    </script>
    <style>
        body {
            position: absolute;
            width: 100%;
            height: 100%;
            left: 0;
            top: 0;
            margin: 0;
            overflow-x: hidden;
        }

        canvas {
            position: absolute;
            top: 0;
            left: 0;
        }
    </style>

</body>

</html>