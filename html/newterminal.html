<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <p class="logs logstyle"></p>
    <p class="prefix">></p><p class="textenter"></p><div class="cursor"></div>
    <div class='lhr logstyle'>A</div>
    <script>
        const logs = document.querySelector('.logs')
        const prefix = document.querySelector('.prefix')
        const textenter = document.querySelector('.textenter')
        const cursor = document.querySelector('.cursor')
        const lhr = document.querySelector('.lhr').clientHeight
        document.querySelector('.lhr').remove()
        let w = document.body.clientWidth;
        let h = document.body.clientHeight;
        let keysdown = []
        let logsheight = lhr;
        let vars = {}
        function command(input){
            let args = input.split(' ')
            let flags = args.filter(i => i.split('')[0] === '-').map(i => i = i.slice(1))
            let cmd = args[0]
            if(cmd === 'print'){
                let strprint = args.splice(1)
                let finish = true
                strprint.forEach(function(i,v){
                    console.log(i)
                    if(i.slice(0,1) === '$'){
                        if(vars[i.slice(1)]!=null){
                        strprint[v] = vars[i.slice(1)]
                        } else {
                            command('print ERROR: Variable "'+i.slice(1)+'" is not defined')
                        }
                    }
                })
                logs.textContent+=strprint.join(' ').replaceAll('\\','')+'\r\n'
                logsheight += lhr;
                textenter.style.top = logsheight+'px'
                prefix.style.top = logsheight + 'px'
            } else if(cmd == 'solve'){
                let n1 = args[1]
                let n2 = args[3]
                if(vars[args[1]]){
                    n1 = vars[args[1]]
                }
                if(vars[args[3]]){
                    n2 = vars[args[3]]
                }
                if(!n1 || !n2) return command('print ERROR: Command solve requires 3 arguments <n1> <operator> <n2>');
                if(isNaN(n2)) command('print ERROR: Invalid Input Type "'+n2+'" ')
                if(args[2] === '+'){
                    command('print \\'+args[1]+' + '+args[3]+' = '+ (Number(n1)+ Number(n2)))
                } else if(args[2] === '*'){
                    command('print \\'+args[1]+' * '+args[3]+' = '+ (Number(n1)*Number(n2)))
                } else {
                    command('print ERROR: Invalid Operator "'+args[2]+'" ')
                }
            } else if(cmd === 'let'){
                vars[args[1]] = args.splice(3).join(' ')
                command('print \\'+args[1]+' = '+vars[args[1]])
            } else {
                command('print Unknown command "'+cmd+'"')
            }
        }
        document.body.onkeydown = (e) => {
            if(!keysdown.includes(e.key)&&(e.key.length === 1 || e.key === 'Enter')) keysdown.push(e.key);
            if(e.key.length === 1){
                textenter.textContent+=e.key
            }

            if(keysdown.includes('Enter')){
                if(textenter.textContent!=''){
                let inputsmult = textenter.textContent.split('&&')
                inputsmult.forEach((i,v) => {
                    if(i.slice(0,1) === ' '){
                        i = i.slice(1)
                    }
                    command(i)
                })
                textenter.textContent = ''
                }
            }
            if(e.key === 'Backspace'){
                textenter.textContent = textenter.textContent.slice(0,-1)
            }
        }
        document.body.onkeyup = (e) => {
            keysdown = keysdown.filter(i => i!=e.key)
        }
</script>
<style>
    body {
        position:absolute;
        left:0%;
        top:0%;
        width:100%;
        height:100%;
        overflow-x:hidden;
    }
    .logstyle {
        position:absolute;
        left:15px;
        top:0px;
        width:100%;
        white-space:pre;
    }
    .textenter {
        position:absolute;
        left:15px;
        top:0px;
        width:100%;
        overflow-x:wrap;
    }
    .prefix{
        position:absolute;
        left:5px;
        top:0px;
        width:10px;
        }
</style>
</body>
</html>